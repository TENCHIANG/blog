### 安装安卓模拟器

* 雷电模拟器
* 遁地模拟器（官网有）
* 安装 指端精灵（调试版）
  * `ais/apk/dAisApp.apk`
* 分辨率设置为 `720p` （**红手指**云手机平台默认分辨率）

### 指端精灵脚本调试

* 勾选 `免脚本配置运行` （不用在手机里点击会自动运行脚本）
* 点击 **运行**，运行脚本调试
* 点击 **停止**，停止脚本调试

#### 图色助手

* 先点击快照（比红手指截图快）
* 然后选择坐标体系（home键方位）：`setrotatescreen`
  * 0 下
  * 1 右
  * 2 左
  * 3 上
* 点击截图上的点，`Ctrl+1` 获取 **绝对坐标** 和 **颜色值** 到右边的 第 1 栏 总共有 1 ~ 0 十个
  * 模拟轻点 `tap(x, y)`

#### 多点找色

`findmulticolor`、`findmulticolorex`

* 去图色助手先生成快照、选择坐标体系设置后，打三个点
* 左边 选取范围
* 右边勾选 坐标+多点同步复制
* 点击 多点找色 的 复制（此时已经复制六个参数，还差 `sim`、`scantype`）
* `findmulticolor(x1, y1, x2, y2, color, OffsetPos, sim, scantype)`
  * `sim` 相似度
    * 0.1~1.0（一般0.9）
  * `scantype` 扫描方式（一般选0就行）
    * 0 从左上到右下
    * 1 从中间到四周
    * 2 从右下到左上
  * 会返回 `x, y` 如果没找到则返回 `-1`

```lua
function floatwinrun()
    
	setrotatescreen(0) -- 设置home键在下
    --[[
    local ms = 300
    local count = 0
    local x, y = 624, 401
    while true do
		tap(x, y)
        count = count + 1
        messagebox('已点击' .. count .. '次')
        print(os.date())
        sleep(ms)
    end
    --]]
    
    -- 找到微信图标
    --[[
    local x, y = findmulticolor(407,217,478,290,"02E16E-000000","66|0|02E16E-000000,37|68|07C160-000000", 0.9, 0)
    lineprint(x .. ' ' .. y)
    if (x == -1 or y == -1) then
        messagebox('找不到微信图标')
    else
		tap(x, y)
        messagebox('已找到微信图标')
	end
    
    local login = {}
    login.x, login.y = findmulticolor(37,1158,259,1245,"07C160-000000","-109|82|07C160-000000,105|83|07C160-000000", 0.9, 0)
	lineprint(login.x .. ' ' .. login.y)
    if (login.x == -1 or login.y == -1) then
        messagebox('找不到微信图标')
    else
		tap(x, y)
        messagebox('已找到微信图标')
	end
    --]]
    keypress(3) -- 先返回home
    sleep(1000)
    judge('微信图标', tap, 407,217,478,290,"02E16E-000000","66|0|02E16E-000000,37|68|07C160-000000")
	sleep(1000)
    judge('登录图标', tap, 37,1158,259,1245,"07C160-000000","-109|82|07C160-000000,105|83|07C160-000000")
	sleep(1000)
    judge('取消登录', tap, 29,78,56,107,"000000-000000","11|12|000000-000000,23|23|000000-000000")
end

--[[
@name {string} 找色名称
@action {function} 找色成功后执行的函数 参数 x, y
后面都是 findmulticolor 的参数了 (除了sim,scantype 默认值为 0.9, 0)
@return {x, y}
--]]
function judge (name, action, x1, y1, x2, y2, color, OffsetPos)
    
	assert(type(action) == 'function', '期望action为function实际接收' .. type(action))
  
    local x, y = findmulticolor(x1, y1, x2, y2, color, OffsetPos, 0.9, 0)
    lineprint(name .. ': ' .. x .. ' ' .. y)
    
    local ret = false
    if (x == -1 or y == -1) then
        messagebox('找不到' .. name)
    else
		action(x, y)
        messagebox('已找到' .. name)
        ret = true
	end
    
    return ret
end
```

